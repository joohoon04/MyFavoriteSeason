<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2025 by joohoon04 (http://jsbin.com/nekidic/2/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyFavoriteSeason</title>
    <link rel="stylesheet" href="styles.css">
<style id="jsbin-css">
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

:root {
    --primary-color: #FFC107; /* Amber */
    --secondary-color: #FFAB91; /* Light Pastel Coral */
    --background-color: #E3F2FD; /* Light Blue */
    --card-background: #FFFFFF;
    --text-color: #424242;
    --border-color: #E0E0E0;
    --shadow-color: rgba(0, 0, 0, 0.1);
    --spring-color: #9CCC65;  /* ë´„ ì—°ì´ˆë¡ */
    --summer-color: #29B6F6;  /* ì—¬ë¦„ í•˜ëŠ˜ íŒŒë‘ */
    --autumn-color: #FB8C00;  /* ê°€ì„ ì£¼í™© */
    --winter-color: #90A4AE;  /* ê²¨ìš¸ íšŒì²­ */
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans KR', sans-serif;
    background-color: var(--background-color);
    color: var(--text-color);
    line-height: 1.6;
}

.container {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
}

header {
    text-align: center;
    margin-bottom: 40px;
}

header h1 {
    color: var(--secondary-color);
    margin-bottom: 10px;
}

#record-form {
    background-color: var(--card-background);
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px var(--shadow-color);
    margin-bottom: 40px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 700;
}

input[type="date"], select, textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-size: 1rem;
    font-family: 'Noto Sans KR', sans-serif;
}

textarea {
    resize: vertical;
}

.mood-selector {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.mood-selector input[type="radio"] {
    display: none;
}

.mood-selector label {
    padding: 10px 15px;
    border: 1px solid var(--border-color);
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.mood-selector input[type="radio"]:checked + label{
  background-color: var(--primary-color);
  color: var(--card-background);
  border-color: var(--primary-color);
  font-weight:700;
}

/* ê³„ì ˆë³„ë¡œë§Œ ìƒ‰ìƒ ë‹¤ë¥´ê²Œ */
#mood-spring:checked + label {
    background-color: var(--spring-color);
    border-color: var(--spring-color);
}

#mood-summer:checked + label {
    background-color: var(--summer-color);
    border-color: var(--summer-color);
}

#mood-autumn:checked + label {
    background-color: var(--autumn-color);
    border-color: var(--autumn-color);
}

#mood-winter:checked + label {
    background-color: var(--winter-color);
    border-color: var(--winter-color);
}

button[type="submit"] {
    width: 100%;
    padding: 15px;
    background-color: var(--secondary-color);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

button[type="submit"]:hover {
    background-color: #FF8A65; /* Deeper Pastel Coral */
}

.chart-container {
    max-width: 450px;
    margin: 0 auto;
}

.stats-section {
    background-color: var(--card-background);
    padding: 20px 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px var(--shadow-color);
    margin-bottom: 40px;
    text-align: center;
}

.stats-section h3 {
    margin-bottom: 15px;
    color: var(--secondary-color);
}

#stats-container {
    display: flex;
    justify-content: center;
    gap: 30px;
    flex-wrap: wrap;
}

#stats-container p {
    font-size: 1.1rem;
}

#stats-container span {
    font-weight: 700;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
    background-color: #FFF3E0;
    gap: 10px;
}

.records-section h2 {
    margin-bottom: 0;
    text-align: left;
}

#export-excel {
    padding: 8px 15px;
    background-color: var(--primary-color);
    color: var(--text-color);
    border: none;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#export-excel:hover {
    background-color: #FFD54F; /* Lighter Amber */
}

.records-section h2 {
    text-align: center;
    margin-bottom: 20px;
    color: var(--secondary-color);
}

/* ê²Œì‹œíŒ ëª©ë¡ ìŠ¤íƒ€ì¼ */
.records-list-container {
    background-color: var(--card-background);
    border-radius: 12px;
    box-shadow: 0 4px 15px var(--shadow-color);
    overflow: hidden; /* ìì‹ ìš”ì†Œì˜ radius ì ìš©ì„ ìœ„í•´ */
}

.records-header, .record-row {
    display: grid;
    grid-template-columns: 120px 1fr 120px 100px 80px;  
    gap: 15px;
    padding: 15px 20px;
    align-items: center;
    border-bottom: 1px solid var(--border-color);
}

.records-header {
    font-weight: 700;
    background-color: #f9f9f9;
    color: var(--text-color);
    border-bottom: 2px solid var(--border-color);
}

.records-header > div:nth-child(3) {
    /* ë°˜ì‘ í—¤ë” */
}

.record-row:last-child {
    border-bottom: none;
}

.record-row:hover {
    background-color: #fefcf5;
}

.record-type.deed {
    color: #FFC107;
    font-weight: 700;
}

.record-type.help {
    color: #FF7043;
    font-weight: 700;
}

.record-content {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.record-date {
    font-size: 0.9rem;
    color: #757575;
    text-align: center;
}

.record-mood {
    font-size: 1.2rem;
    text-align: center;
}


footer {
    text-align: center;
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
    font-size: 0.9rem;
    color: #757575;
}

/* Responsive Design */
@media (max-width: 768px) {
    .records-header {
        display: none; /* ëª¨ë°”ì¼ì—ì„œëŠ” í—¤ë” ìˆ¨ê¹€ */
    }

    .records-list-container {
        background-color: transparent;
        box-shadow: none;
    }

    .record-row {
        grid-template-columns: 1fr; /* 1ì—´ë¡œ ë³€ê²½ */
        gap: 10px;
        margin-bottom: 15px;
        border-radius: 12px;
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 15px var(--shadow-color);
        background-color: var(--card-background);
        padding: 20px;
    }

    .record-row > div::before {
        font-weight: 700;
        margin-right: 10px;
        color: var(--secondary-color);
    }

    .record-type::before { content: 'ì¢…ë¥˜: '; }
    .record-content::before { content: 'ë‚´ìš©: '; }
    .record-date::before { content: 'ë‚ ì§œ: '; }
    .record-mood::before { content: 'ê¸°ë¶„: '; }

    .record-content {
        white-space: normal;
        overflow: visible;
        text-overflow: initial;
    }

    .record-date, .record-mood {
        text-align: left;
    }
}

</style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆ</h1>
            <p>ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆê³¼ ì´ìœ ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”.</p>
        </header>
        <main>
            <form id="record-form">
                <div class="form-group">
                    <label for="type">ì¢‹ì•„í•˜ëŠ” ê³„ì ˆ</label>
                    <select id="type" name="type">
                        <option value="deed">ğŸŒ¸ ë´„</option>
                        <option value="help">ğŸŒ» ì—¬ë¦„</option>
                        <option value="help">ğŸ ê°€ì„</option>
                        <option value="help">â„ï¸ ê²¨ìš¸</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">ë‚ ì§œ</label>
                    <input type="date" id="date" name="date" required>
                </div>
                <div class="form-group">
                    <label for="content">ì™œ ì´ ê³„ì ˆì„ ì¢‹ì•„í•˜ë‚˜ìš”?</label>
                    <textarea id="content" name="content" rows="4" placeholder="ì˜ˆ: ë´„ì€ ê½ƒì´ í”¼ê³  ë”°ëœ»í•´ì„œ ì¢‹ì•„ìš”." required></textarea>
                </div>
                <div class="form-group">
                    <label for="reaction">ì´ ê³„ì ˆì— í•˜ê³  ì‹¶ì€ í™œë™</label>
                    <input type="text" id="reaction" name="reaction" placeholder="ì˜ˆ: ê°€ì„ì—” ë‹¨í’ êµ¬ê²½í•˜ê¸°">
                </div>
                <div class="form-group">
                    <label>ê³„ì ˆì„ ë– ì˜¬ë ¸ì„ ë•Œ ê¸°ë¶„</label>
                    <div class="mood-selector">
                        <input type="radio" id="mood-spring" name="mood" value="ìƒì¾Œ" checked>
                        <label for="mood-happy">ğŸƒ ìƒì¾Œ</label>
                        <input type="radio" id="mood-summer" name="mood" value="ë”°ëœ»í•¨">
                        <label for="mood-proud">ğŸ”¥ ë”°ëœ»í•¨</label>
                        <input type="radio" id="mood-autumn" name="mood" value="ë‚­ë§Œì ">
                        <label for="mood-thankful">ğŸŒ™ ë‚­ë§Œì </label>
                        <input type="radio" id="mood-winter" name="mood" value="ê³ ìš”">
                        <label for="mood-moved">ğŸŒŒ ê³ ìš”</label>
                    </div>
                </div>
                <button type="submit">ë‚´ê°€ ê¸°ë¡í•œ ê³„ì ˆë“¤</button>
            </form>

            <section class="stats-section">
                <h3>ë‚´ê°€ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆ í†µê³„</h3>
                <div class="chart-container">
                    <canvas id="mood-chart"></canvas>
                </div>
            </section>

            <section class="records-section">
                <div class="section-header">
                    <h2>ìš°ë¦¬ì˜ ê¸°ë¡ë“¤</h2>
                    <button id="export-excel">ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°</button>
                </div>
                <div class="records-list-container">
                    <div class="records-header">
                        <div>ì „ì²´</div>
                        <div>ë´„</div>
                        <div>ì—¬ë¦„</div>     
                        <div>ê°€ì„</div>
                        <div>ê²¨ìš¸</div>
                    </div>
                    <div id="records-container">
                        <!-- ê¸°ë¡ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. -->
                    </div>
                </div>
            </section>
        </main>
        <footer>
            <p>&copy; 2025 ë‚˜ì˜ ë”°ëœ»í•œ í•˜ë£¨. All rights reserved.</p>
        </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="script.js"></script>
<script id="jsbin-javascript">
document.addEventListener('DOMContentLoaded', () => {
    // !!! ì¤‘ìš”: README.md íŒŒì¼ì„ ì½ê³ , ë°°í¬ëœ ìì‹ ì˜ Google Apps Script ì›¹ ì•± URLë¡œ ë³€ê²½í•˜ì„¸ìš”.
    const WEB_APP_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';

    const recordForm = document.getElementById('record-form');
    const recordsContainer = document.getElementById('records-container');
    const dateInput = document.getElementById('date');
    const exportButton = document.getElementById('export-excel');
    const moodChartCanvas = document.getElementById('mood-chart');
    let recordsCache = []; // ë°ì´í„° ìºì‹±
    let moodChart;

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ê¸°ë³¸ ì„¤ì •
    dateInput.value = new Date().toISOString().split('T')[0];

    // ë°ì´í„° ë¡œë“œ ë° í™”ë©´ ì—…ë°ì´íŠ¸
    const loadRecords = async () => {
        try {
            const response = await fetch(WEB_APP_URL, { method: 'GET', redirect: 'follow' });
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            recordsCache = await response.json();

            // ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„°ê°€ ë°°ì—´ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤. ë°°ì—´ì´ ì•„ë‹ˆë©´ Apps Script ì—ëŸ¬ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
            if (!Array.isArray(recordsCache)) {
                console.error("Error data received from Google Apps Script:", recordsCache);
                throw new Error('Google Apps Scriptì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ê°œë°œì ë„êµ¬(F12)ì˜ Console íƒ­ì—ì„œ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
            }
            
            recordsContainer.innerHTML = '<p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>';
            // ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬
            // Timestamp ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ë” ì •í™•í•¨)
            recordsCache.sort((a, b) => new Date(b.Timestamp) - new Date(a.Timestamp));
            
            recordsContainer.innerHTML = ''; // ë¡œë”© ë©”ì‹œì§€ ì œê±°
            recordsCache.forEach(addRecordToDOM);
            renderMoodChart();

        } catch (error) {
            console.error('Error loading records:', error);
            recordsContainer.innerHTML = `<p style="color: red;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. README.md íŒŒì¼ì„ í™•ì¸í•˜ì—¬ ì„¤ì •ì„ ì™„ë£Œí–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>`;
        }
    };

    // DOMì— ê¸°ë¡ ëª©ë¡ í–‰ ì¶”ê°€
    const addRecordToDOM = (record) => {
        const row = document.createElement('div');
        row.classList.add('record-row');

        const moodEmojis = { 'í–‰ë³µ': 'ğŸ˜„', 'ë³´í†µ': 'ğŸ˜', 'ìš°ìš¸': 'ğŸ˜”', 'ë¶„ë…¸': 'ğŸ˜¡' };
        const typeText = { 'deed': 'ğŸ˜Š ì„ í–‰í–ˆì–´ìš”', 'help': 'ğŸ’– ë„ì›€ë°›ì•˜ì–´ìš”' };

        row.innerHTML = `
            <div class="record-type ${record.Type}">${typeText[record.Type] || record.Type}</div>
            <div class="record-content" title="${record.Content}">${record.Content}</div>
            <div class="record-reaction" title="${record.Reaction}">${record.Reaction || '-'}</div>
            <div class="record-date">${new Date(record.Date).toLocaleDateString()}</div>
            <div class="record-mood">${moodEmojis[record.Mood] || ''}</div>
        `;
        recordsContainer.appendChild(row);
    };

    // ê¸°ë¶„ í†µê³„ ì°¨íŠ¸ ë Œë”ë§
    const renderMoodChart = () => {
        const moodCounts = recordsCache.reduce((acc, record) => {
            acc[record.Mood] = (acc[record.Mood] || 0) + 1;
            return acc;
        }, {});

        const chartData = {
            labels: Object.keys(moodCounts),
            datasets: [{
                label: 'ê¸°ë¶„ë³„ íšŸìˆ˜',
                data: Object.values(moodCounts),
                backgroundColor: ['#FFC107', '#FF7043', '#8BC34A', '#2196F3', '#9C27B0'],
                hoverOffset: 4
            }]
        };

        if (moodChart) {
            moodChart.destroy(); // ê¸°ì¡´ ì°¨íŠ¸ íŒŒê´´
        }

        moodChart = new Chart(moodChartCanvas, {
            type: 'pie',
            data: chartData,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'ì „ì²´ ê¸°ë¶„ í†µê³„'
                    }
                }
            }
        });
    };

    // í¼ ì œì¶œ ì´ë²¤íŠ¸ ì²˜ë¦¬
    recordForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const submitButton = e.target.querySelector('button[type="submit"]');
        submitButton.disabled = true;
        submitButton.textContent = 'ì €ì¥ ì¤‘...';

        const formData = new FormData(recordForm);
        const data = {
            type: formData.get('type'),
            date: formData.get('date'),
            content: formData.get('content'),
            mood: formData.get('mood'),
            reaction: formData.get('reaction')
        };

        try {
            const response = await fetch(WEB_APP_URL, {
                method: 'POST',
                mode: 'no-cors', // Apps ScriptëŠ” no-cors ëª¨ë“œ ë˜ëŠ” ë³µì¡í•œ CORS ì„¤ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                cache: 'no-cache',
                redirect: 'follow',
                body: JSON.stringify(data)
            });

            // no-cors ëª¨ë“œì—ì„œëŠ” ì‘ë‹µì„ ì§ì ‘ ì½ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
            alert('ì„±ê³µì ìœ¼ë¡œ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            recordForm.reset();
            dateInput.value = new Date().toISOString().split('T')[0];
            loadRecords(); // ë°ì´í„° ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°

        } catch (error) {
            console.error('Error submitting record:', error);
            alert('ê¸°ë¡ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.');
        } finally {
            submitButton.disabled = false;
            submitButton.textContent = 'ê¸°ë¡í•˜ê¸°';
        }
    });

    // ì—‘ì…€ ë‚´ë³´ë‚´ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬
    exportButton.addEventListener('click', () => {
        if (recordsCache.length === 0) {
            alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }

        // ë°ì´í„° ì‹œíŠ¸ ìƒì„±
        const worksheet = XLSX.utils.json_to_sheet(recordsCache);
        // ìƒˆ ì›Œí¬ë¶ ìƒì„±
        const workbook = XLSX.utils.book_new();
        // ì›Œí¬ë¶ì— ë°ì´í„° ì‹œíŠ¸ ì¶”ê°€
        XLSX.utils.book_append_sheet(workbook, worksheet, "ìš°ë¦¬ì˜ ê¸°ë¡");

        // í—¤ë” ìŠ¤íƒ€ì¼ë§ (ì„ íƒ ì‚¬í•­)
        const headers = Object.keys(recordsCache[0]);
        const header_styles = { font: { bold: true } };
        for(let i = 0; i < headers.length; i++){
            const cell_ref = XLSX.utils.encode_cell({c:i, r:0});
            if(worksheet[cell_ref]) {
                worksheet[cell_ref].s = header_styles;
            }
        }

        // ì—‘ì…€ íŒŒì¼ ë‚´ë³´ë‚´ê¸°
        XLSX.writeFile(workbook, "our_kindness_records.xlsx");
    });

    // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
    loadRecords();
});

</script>
</body>
</html>